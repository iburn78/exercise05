{% extends "board/base.html" %}
{% block content %}
{% load static %}
<div class="container-fluid">
  <div class="row">
    <div class="col">
      {% if card.is_public %}
      <img src="{% static 'icons/people-fill.svg' %}" width="24" height="24">
      {% else %}
      <img src="{% static 'icons/person-circle.svg' %}" width="24" height="24">
      {% endif %}
      <b>{{ card.title }}</b>
      {% if user.is_authenticated %}
      <a class="float-end" href="{% url 'card-delete' card_id %}"><img src="{% static 'icons/trash.svg' %}" width="24" height="24"></a>
      <a class="me-2 float-end" href="{% url 'card-update' card_id %}"><img src="{% static 'icons/gear-fill.svg' %}" width="24" height="24"></a>
      <a class="me-2 float-end text-dark" href="{% url 'post-create' card_id %}"><img src="{% static 'icons/pencil-square.svg' %}" width="27" height="27"></a>
      {% endif %}
      <button class="me-2 pb-0 float-end btn btn-sm btn-outline-dark" type="button" data-bs-toggle="collapse" data-bs-target="#collapseDesc">desc</button>
    </div>
  </div>
  <div class="collapse" id="collapseDesc">
    <div id="divider-bar" style="background-color:{{card.card_color}}"></div>
    <div class="row">
      <div class="col-4">
        {% if card.image %}
        <img class="card-img-preview" src="{{ card.image.url }}">
        {% else %}
        <span class="text-muted">no image</span>
        {% endif %}
      </div>
      <div class="col-8">
        {% if card.desc %}
        {{ card.desc }}
        {% else %}
        <span class="text-muted">no description</span>
        {% endif %}
      </div>
    </div>
  </div>
  <div id="divider-bar" style="background-color:{{card.card_color}}"></div>
  
  
  <div class="row">
    {% for post in posts %}
    <div class="col-md-6 col-xl-3 mb-2">
      <div class="row">
        {% if post.image1 %}
        <div class="col-4 pe-0">
          <a href="{% url 'post-detail' post.id %}">
            <img class="img-fluid post-list-image" src="{{ post.image1.url }}">
          </a>
        </div>
        <div class="col-8">
          {% endif %}
          <small class="text-muted">{{ post.date_posted|date:"M d, Y H:m" }}</small>
          <a href="{% url 'post-detail' post.id %}">
            <p class="article-content mt-2 mb-1 post-list-content-size text-dark">{{ post.content }}</p>
          </a>
          {% for tag in post.tags.all %}
          <a href="" class="ms-1 badge bg-primary mt-1">#{{ tag }}</a>
          {% endfor %}
          {% if post.image1 %}
        </div>
        {% endif %}
      </div>
    </div>
    {% endfor %}
  </div>
  
  <div class="container-fluid">
    {% if is_paginated %}
    {% if page_obj.has_previous %}
    <a class="btn btn-outline-info mb-4" href="?page=1">first</a>
    {% endif %}
    
    {% for num in page_obj.paginator.page_range %}
    {% if page_obj.number == num %}
    <a class="btn btn-info mb-4" href="?page={{ num }}">{{ num }}</a>
    {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
    <a class="btn btn-outline-info mb-4" href="?page={{ num }}">{{ num }}</a>
    {% endif %}
    {% endfor %}
    
    {% if page_obj.has_next %}
    <a class="btn btn-outline-info mb-4" href="?page={{ page_obj.paginator.num_pages }}">last</a>
    {% endif %}
    {% endif %}
  </div>
  {% endblock content %}
  